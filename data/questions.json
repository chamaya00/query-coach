[
  {
    "id": "q_1768076194391_yatmhj",
    "difficulty": "beginner",
    "question": "Find all products in the Sports category",
    "hint": "SELECT name, price, stock_quantity \nFROM products \nWHERE category = 'Sport'",
    "generatedAt": "2026-01-10T20:16:34.391Z",
    "fingerprint": "products-category-equals"
  },
  {
    "id": "q_1768076199135_t60mla",
    "difficulty": "beginner",
    "question": "Find all products with a price less than $50",
    "hint": "SELECT name, price FROM products WHERE price <= 50;",
    "generatedAt": "2026-01-10T20:16:39.135Z",
    "fingerprint": "products-price-less-than"
  },
  {
    "id": "q_1768076203709_2w0qa3",
    "difficulty": "beginner",
    "question": "Show all products with a price less than $50",
    "hint": "SELECT name, price FROM products WHERE price <= 50;",
    "generatedAt": "2026-01-10T20:16:43.709Z",
    "fingerprint": "products-price-less-than"
  },
  {
    "id": "q_1768076208447_jxowc5",
    "difficulty": "beginner",
    "question": "Find all products in the Electronics category",
    "hint": "SELECT id, name, category, price \nFROM products \nWHERE category = 'Electronic'",
    "generatedAt": "2026-01-10T20:16:48.447Z",
    "fingerprint": "products-category-equals"
  },
  {
    "id": "q_1768076213279_c4gjch",
    "difficulty": "beginner",
    "question": "Find all products in the Sports category",
    "hint": "SELECT id, name, price \nFROM products \nWHERE category = 'Sport';",
    "generatedAt": "2026-01-10T20:16:53.279Z",
    "fingerprint": "products-category-equals"
  },
  {
    "id": "q_1768076218256_ky6d9h",
    "difficulty": "beginner",
    "question": "Find all products with a price less than $50",
    "hint": "SELECT name, price FROM products WHERE price <= 50;",
    "generatedAt": "2026-01-10T20:16:58.256Z",
    "fingerprint": "products-price-less-than"
  },
  {
    "id": "q_1768076222937_8ct2w7",
    "difficulty": "beginner",
    "question": "Find all products in the Sports category",
    "hint": "SELECT name, price FROM products WHERE category = 'Sport';",
    "generatedAt": "2026-01-10T20:17:02.937Z",
    "fingerprint": "products-category-equals"
  },
  {
    "id": "q_1768076228008_5vbrlv",
    "difficulty": "beginner",
    "question": "Find all products in the Sports category",
    "hint": "SELECT id, name, price, stock_quantity\nFROM products\nWHERE category = 'Sport';",
    "generatedAt": "2026-01-10T20:17:08.008Z",
    "fingerprint": "products-category-equals"
  },
  {
    "id": "q_1768076232615_mg82bb",
    "difficulty": "beginner",
    "question": "Find all products with a price less than $50",
    "hint": "SELECT name, price FROM products WHERE price <= 50;",
    "generatedAt": "2026-01-10T20:17:12.616Z",
    "fingerprint": "products-price-less-than"
  },
  {
    "id": "q_1768076237261_05a82e",
    "difficulty": "beginner",
    "question": "Find all products in the Sports category",
    "hint": "SELECT id, name, price \nFROM products \nWHERE category = 'Sport'",
    "generatedAt": "2026-01-10T20:17:17.261Z",
    "fingerprint": "products-category-equals"
  },
  {
    "id": "q_1768076245364_37v2o0",
    "difficulty": "intermediate",
    "question": "Find the average order value for each customer region",
    "hint": "SELECT c.region, AVG(o.total_amount) AS avg_order_value\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nWHERE o.status = 'completed'\nGROUP BY c.region",
    "generatedAt": "2026-01-10T20:17:25.364Z",
    "fingerprint": "customers-orders-region-avg-group"
  },
  {
    "id": "q_1768076255174_aucogk",
    "difficulty": "intermediate",
    "question": "Find all customers who have placed more than 2 orders",
    "hint": "SELECT c.name, COUNT(o.id) as order_count\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nWHERE COUNT(o.id) > 2\nGROUP BY c.name",
    "generatedAt": "2026-01-10T20:17:35.174Z",
    "fingerprint": "customers-orders-count-greater"
  },
  {
    "id": "q_1768076266500_24wioe",
    "difficulty": "intermediate",
    "question": "Find all customers who have placed orders with a total amount greater than $500",
    "hint": "SELECT c.name, c.email\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nWHERE o.total_amount > 500\nGROUP BY c.name, c.email",
    "generatedAt": "2026-01-10T20:17:46.500Z",
    "fingerprint": "customers-orders-amount-greater"
  },
  {
    "id": "q_1768076276871_1wqwco",
    "difficulty": "intermediate",
    "question": "Show the total quantity sold for each product category",
    "hint": "SELECT p.category, SUM(oi.quantity) as total_quantity\nFROM products p, order_items oi\nWHERE p.id = oi.product_id\nGROUP BY p.category",
    "generatedAt": "2026-01-10T20:17:56.871Z",
    "fingerprint": "products-category-quantity-sum-group"
  },
  {
    "id": "q_1768076286896_llk3as",
    "difficulty": "intermediate",
    "question": "Find the total quantity sold for each product category",
    "hint": "SELECT p.category, SUM(oi.quantity) as total_quantity\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nWHERE p.category IS NOT NULL\nGROUP BY p.category",
    "generatedAt": "2026-01-10T20:18:06.896Z",
    "fingerprint": "products-category-quantity-sum-group"
  },
  {
    "id": "q_1768076297347_ugnkvd",
    "difficulty": "intermediate",
    "question": "Find customers who have placed orders in both January and February 2024",
    "hint": "SELECT DISTINCT c.id, c.name\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nWHERE o.order_date >= '2024-01-01' \n  AND o.order_date < '2024-03-01'\nGROUP BY c.id, c.name\nHAVING COUNT(*) >= 2",
    "generatedAt": "2026-01-10T20:18:17.347Z",
    "fingerprint": "customers-orders-months-both-exists"
  },
  {
    "id": "q_1768076308417_ehwsis",
    "difficulty": "intermediate",
    "question": "Find the total revenue generated by each product category",
    "hint": "SELECT \n  p.category,\n  SUM(oi.quantity * oi.unit_price) AS total_revenue\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nWHERE o.status = 'completed'\nGROUP BY p.category\nORDER BY total_revenue DESC",
    "generatedAt": "2026-01-10T20:18:28.417Z",
    "fingerprint": "products-category-revenue-sum-group"
  },
  {
    "id": "q_1768076318323_0w1864",
    "difficulty": "intermediate",
    "question": "Find the total quantity sold for each product category",
    "hint": "SELECT p.category, SUM(oi.quantity) as total_quantity\nFROM products p, order_items oi\nWHERE p.id = oi.product_id\nGROUP BY p.category",
    "generatedAt": "2026-01-10T20:18:38.323Z",
    "fingerprint": "products-category-quantity-sum-group"
  },
  {
    "id": "q_1768076329894_x9yezw",
    "difficulty": "intermediate",
    "question": "Find all customers who have placed orders in both January and February 2024",
    "hint": "SELECT DISTINCT c.name, c.email\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nWHERE (o.order_date >= '2024-01-01' AND o.order_date < '2024-02-01')\n   OR (o.order_date >= '2024-02-01' AND o.order_date < '2024-03-01')",
    "generatedAt": "2026-01-10T20:18:49.894Z",
    "fingerprint": "customers-orders-months-both-exists"
  },
  {
    "id": "q_1768076339860_ibkzta",
    "difficulty": "intermediate",
    "question": "Find the total quantity of each product sold across all orders",
    "hint": "SELECT p.name, SUM(oi.quantity) as total_sold\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nWHERE p.stock_quantity > 0\nGROUP BY p.name",
    "generatedAt": "2026-01-10T20:18:59.860Z",
    "fingerprint": "products-orders-quantity-sum-group"
  },
  {
    "id": "q_1768076352317_ohexqm",
    "difficulty": "advanced",
    "question": "Find customers who have spent more on Electronics products than on all other categories combined",
    "hint": "WITH customer_spending AS (\n  SELECT \n    c.id,\n    c.name,\n    p.category,\n    SUM(oi.quantity * oi.unit_price) as category_spending\n  FROM customers c\n  JOIN orders o ON c.id = o.customer_id\n  JOIN order_items oi ON o.id = oi.order_id\n  JOIN products p ON oi.product_id = p.id\n  WHERE o.status = 'completed'\n  GROUP BY c.id, c.name, p.category\n),\nspending_comparison AS (\n  SELECT \n    id,\n    name,\n    SUM(CASE WHEN category = 'Electronics' THEN category_spending ELSE 0 END) as electronics_spending,\n    SUM(CASE WHEN category != 'Electronics' THEN category_spending ELSE 0 END) as other_spending\n  FROM customer_spending\n  GROUP BY id, name\n)\nSELECT id, name, electronics_spending, other_spending\nFROM spending_comparison\nWHERE electronics_spending > other_spending\nAND electronics_spending > 0;",
    "generatedAt": "2026-01-10T20:19:12.317Z",
    "fingerprint": "customers-products-electronics-category-compare-sum"
  },
  {
    "id": "q_1768076358986_e09rki",
    "difficulty": "advanced",
    "question": "Find products that have been purchased by customers from all three regions",
    "hint": "SELECT p.id, p.name\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nJOIN orders o ON oi.order_id = o.id\nJOIN customers c ON o.customer_id = c.id\nWHERE c.region IN ('West', 'East', 'Central')\nGROUP BY p.id, p.name\nHAVING COUNT(DISTINCT c.region) = 3;",
    "generatedAt": "2026-01-10T20:19:18.986Z",
    "fingerprint": "products-customers-regions-all-join"
  },
  {
    "id": "q_1768076369651_kiqii5",
    "difficulty": "advanced",
    "question": "Find products that have been ordered by customers from all three regions",
    "hint": "SELECT p.id, p.name\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nJOIN orders o ON oi.order_id = o.id\nJOIN customers c ON o.customer_id = c.id\nWHERE c.region IN ('West', 'East', 'Central')\nGROUP BY p.id, p.name\nHAVING COUNT(DISTINCT c.region) >= 3",
    "generatedAt": "2026-01-10T20:19:29.651Z",
    "fingerprint": "products-customers-regions-all-join"
  },
  {
    "id": "q_1768076380718_j0w981",
    "difficulty": "advanced",
    "question": "Find customers who have ordered products from at least 3 different categories",
    "hint": "WITH customer_categories AS (\n    SELECT \n        c.id,\n        c.name,\n        p.category\n    FROM customers c\n    JOIN orders o ON c.id = o.customer_id\n    JOIN order_items oi ON o.id = oi.order_id\n    JOIN products p ON oi.product_id = p.id\n    WHERE o.status = 'completed'\n    GROUP BY c.id, c.name, p.category\n),\ncategory_counts AS (\n    SELECT \n        id,\n        name,\n        COUNT(category) as category_count\n    FROM customer_categories\n    GROUP BY id, name\n)\nSELECT id, name\nFROM category_counts\nWHERE category_count >= 3;",
    "generatedAt": "2026-01-10T20:19:40.718Z",
    "fingerprint": "customers-products-categories-count-min"
  },
  {
    "id": "q_1768076394449_wtlpze",
    "difficulty": "advanced",
    "question": "Find customers who have placed orders in every month that any customer has placed an order",
    "hint": "WITH monthly_orders AS (\n    SELECT DISTINCT \n        strftime('%Y-%m', order_date) as order_month,\n        customer_id\n    FROM orders\n),\nall_months AS (\n    SELECT DISTINCT strftime('%Y-%m', order_date) as order_month\n    FROM orders\n),\ncustomer_month_counts AS (\n    SELECT \n        customer_id,\n        COUNT(DISTINCT order_month) as months_with_orders\n    FROM monthly_orders\n    GROUP BY customer_id\n),\ntotal_months AS (\n    SELECT COUNT(*) as total_month_count\n    FROM all_months\n)\nSELECT \n    c.id,\n    c.name\nFROM customers c\nJOIN customer_month_counts cmc ON c.id = cmc.customer_id\nWHERE cmc.months_with_orders = (SELECT total_month_count FROM total_months)",
    "generatedAt": "2026-01-10T20:19:54.449Z",
    "fingerprint": "customers-orders-months-all-division"
  },
  {
    "id": "q_1768076403863_trmpdp",
    "difficulty": "advanced",
    "question": "Find customers who have ordered from all product categories available in the store",
    "hint": "SELECT c.name, c.email\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nWHERE c.id IN (\n    SELECT customer_id\n    FROM orders o2\n    JOIN order_items oi2 ON o2.id = oi2.order_id\n    JOIN products p2 ON oi2.product_id = p2.id\n    GROUP BY customer_id\n    HAVING COUNT(DISTINCT p2.category) = (\n        SELECT COUNT(DISTINCT category) FROM products\n    )\n)\nGROUP BY c.id, c.name, c.email;",
    "generatedAt": "2026-01-10T20:20:03.863Z",
    "fingerprint": "customers-categories-all-exists"
  },
  {
    "id": "q_1768076413714_c9chtc",
    "difficulty": "advanced",
    "question": "Find customers who have ordered products from at least 3 different categories",
    "hint": "SELECT c.id, c.name\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nGROUP BY c.id, c.name\nHAVING COUNT(DISTINCT p.category) >= 3",
    "generatedAt": "2026-01-10T20:20:13.714Z",
    "fingerprint": "customers-products-categories-count-having"
  },
  {
    "id": "q_1768076424372_6nsafp",
    "difficulty": "advanced",
    "question": "Find customers who have ordered products from at least three different categories",
    "hint": "SELECT c.id, c.name\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nGROUP BY c.id, c.name\nHAVING COUNT(p.category) >= 3",
    "generatedAt": "2026-01-10T20:20:24.372Z",
    "fingerprint": "customers-products-categories-count-min"
  },
  {
    "id": "q_1768076434640_zfb422",
    "difficulty": "advanced",
    "question": "Find customers who have ordered products from at least 3 different categories",
    "hint": "SELECT c.name, c.email\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nGROUP BY c.id, c.name, c.email\nHAVING COUNT(p.category) >= 3",
    "generatedAt": "2026-01-10T20:20:34.640Z",
    "fingerprint": "customers-products-categories-count-threshold"
  },
  {
    "id": "q_1768076444944_poi01l",
    "difficulty": "advanced",
    "question": "Find customers who have ordered products from at least 3 different categories",
    "hint": "SELECT c.id, c.name\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nGROUP BY c.id, c.name\nHAVING COUNT(p.category) >= 3",
    "generatedAt": "2026-01-10T20:20:44.944Z",
    "fingerprint": "customers-products-categories-count-min"
  },
  {
    "id": "q_1768111363947_gfi35k",
    "difficulty": "beginner",
    "question": "Find all customers who joined in 2023",
    "fingerprint": "customers-joined-year-equals",
    "hint": "SELECT name, email, region, created_date\nFROM customers\nWHERE created_at >= '2023-01-01' AND created_at < '2024-01-01';",
    "generatedAt": "2026-01-11T06:02:43.947Z"
  },
  {
    "id": "q_1768111371064_dwmeig",
    "difficulty": "beginner",
    "question": "Find all orders with a total amount greater than 200",
    "fingerprint": "orders-total-greater",
    "hint": "SELECT id, customer_id, order_date, status, total_amount\nFROM orders\nWHERE total_amount > 200.00",
    "generatedAt": "2026-01-11T06:02:51.064Z"
  },
  {
    "id": "q_1768111378750_0bx08g",
    "difficulty": "beginner",
    "question": "Find all products with stock quantity greater than 100",
    "fingerprint": "products-stock-greater",
    "hint": "SELECT name, category, price, stock_qty \nFROM products \nWHERE stock_quantity > 100;",
    "generatedAt": "2026-01-11T06:02:58.750Z"
  },
  {
    "id": "q_1768111386275_1ois5e",
    "difficulty": "beginner",
    "question": "Find all orders with a status of 'shipped'",
    "fingerprint": "orders-status-equals",
    "hint": "SELECT * FROM orders WHERE status = 'ship'",
    "generatedAt": "2026-01-11T06:03:06.275Z"
  },
  {
    "id": "q_1768111393630_d49izl",
    "difficulty": "beginner",
    "question": "Find all customers who created their account in 2023",
    "fingerprint": "customers-created-year-equals",
    "hint": "SELECT name, email, region FROM customers WHERE created_at LIKE '2023%'",
    "generatedAt": "2026-01-11T06:03:13.630Z"
  },
  {
    "id": "q_1768111401448_c0chkr",
    "difficulty": "beginner",
    "question": "Show all customers who joined in 2023",
    "fingerprint": "customers-joined-2023-equals",
    "hint": "SELECT id, name, email, region, created_at\nFROM customers\nWHERE created_at LIKE '2023%'",
    "generatedAt": "2026-01-11T06:03:21.448Z"
  },
  {
    "id": "q_1768111408878_3tu63h",
    "difficulty": "beginner",
    "question": "Find all products with stock quantity greater than 100",
    "fingerprint": "products-stock-greater",
    "hint": "SELECT name, category, price, stock_qty \nFROM products \nWHERE stock_quantity > 100",
    "generatedAt": "2026-01-11T06:03:28.878Z"
  },
  {
    "id": "q_1768111416108_tgn8at",
    "difficulty": "beginner",
    "question": "Find all orders with a total amount greater than 100",
    "fingerprint": "orders-total-greater",
    "hint": "SELECT id, customer_id, order_date, status, total_amount\nFROM orders\nWHERE total_amount > 100.00",
    "generatedAt": "2026-01-11T06:03:36.108Z"
  },
  {
    "id": "q_1768111423231_680rmz",
    "difficulty": "beginner",
    "question": "Show all orders placed in February 2024",
    "fingerprint": "orders-date-february",
    "hint": "SELECT id, customer_id, order_date, status, total_amount\nFROM orders\nWHERE order_date >= '2024-02-01' AND order_date < '2024-03-01'",
    "generatedAt": "2026-01-11T06:03:43.231Z"
  },
  {
    "id": "q_1768111431227_ns3o96",
    "difficulty": "beginner",
    "question": "Find the 3 cheapest products in the database",
    "fingerprint": "products-price-order-limit",
    "hint": "SELECT name, price FROM products ORDER BY price LIMIT 3;",
    "generatedAt": "2026-01-11T06:03:51.227Z"
  },
  {
    "id": "q_1768111438916_1q2h18",
    "difficulty": "intermediate",
    "question": "Find products that have been ordered more than twice",
    "fingerprint": "products-orders-count-greater",
    "hint": "SELECT p.id, p.name, COUNT(oi.product_id) as order_count\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nWHERE COUNT(oi.product_id) > 2\nGROUP BY p.id, p.name\nORDER BY order_count DESC",
    "generatedAt": "2026-01-11T06:03:58.916Z"
  },
  {
    "id": "q_1768111447118_gqq76s",
    "difficulty": "intermediate",
    "question": "Show the average order value for each order status",
    "fingerprint": "orders-status-avg-group",
    "hint": "SELECT status, AVG(total_amount) as average_order_value\nFROM orders\nGROUP BY status\nHAVING COUNT(*) > 2",
    "generatedAt": "2026-01-11T06:04:07.118Z"
  },
  {
    "id": "q_1768111454430_ompyb7",
    "difficulty": "intermediate",
    "question": "Find products that have been ordered more than twice",
    "fingerprint": "products-orders-count-greater",
    "hint": "SELECT p.name, COUNT(oi.product_id) as order_count\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nWHERE COUNT(oi.product_id) > 2\nGROUP BY p.name",
    "generatedAt": "2026-01-11T06:04:14.430Z"
  },
  {
    "id": "q_1768111462061_g2gg2v",
    "difficulty": "intermediate",
    "question": "Find products that have been ordered by customers from at least two different regions",
    "fingerprint": "products-customers-regions-count-min",
    "hint": "SELECT DISTINCT p.name\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nJOIN orders o ON oi.order_id = o.id\nJOIN customers c ON o.customer_id = c.id\nGROUP BY p.name\nHAVING COUNT(DISTINCT c.region) >= 2",
    "generatedAt": "2026-01-11T06:04:22.061Z"
  },
  {
    "id": "q_1768111469899_uh17rp",
    "difficulty": "intermediate",
    "question": "Find products that have been ordered by customers from at least two different regions",
    "fingerprint": "products-customers-regions-count-min",
    "hint": "SELECT p.id, p.name\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nJOIN orders o ON oi.order_id = o.id\nJOIN customers c ON o.customer_id = c.id\nGROUP BY p.id, p.name\nHAVING COUNT(c.region) >= 2",
    "generatedAt": "2026-01-11T06:04:29.899Z"
  },
  {
    "id": "q_1768111480737_6a6h49",
    "difficulty": "intermediate",
    "question": "Find all products that have never been ordered",
    "fingerprint": "products-orders-not-exists",
    "hint": "SELECT p.name, p.category, p.price\nFROM products p\nLEFT JOIN order_items oi ON p.id = oi.product_id\nWHERE oi.product_id IS NULL\nGROUP BY p.id, p.name, p.category, p.price",
    "generatedAt": "2026-01-11T06:04:40.737Z"
  },
  {
    "id": "q_1768111490977_qc3app",
    "difficulty": "intermediate",
    "question": "Find products that have been ordered by customers from at least 2 different regions",
    "fingerprint": "products-customers-regions-count-atleast",
    "hint": "SELECT p.name\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nJOIN orders o ON oi.order_id = o.id\nJOIN customers c ON o.customer_id = c.id\nGROUP BY p.id, p.name\nHAVING COUNT(c.region) >= 2",
    "generatedAt": "2026-01-11T06:04:50.977Z"
  },
  {
    "id": "q_1768111503051_rbrenp",
    "difficulty": "intermediate",
    "question": "Find customers who have spent more than $500 total across all their orders",
    "fingerprint": "customers-orders-total-greater",
    "hint": "SELECT c.name, SUM(o.total_amount) as total_spent\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nWHERE SUM(o.total_amount) > 500\nGROUP BY c.id, c.name",
    "generatedAt": "2026-01-11T06:05:03.051Z"
  },
  {
    "id": "q_1768111514145_ljdgym",
    "difficulty": "intermediate",
    "question": "Show all products that have never been ordered",
    "fingerprint": "products-orders-not-exists",
    "hint": "SELECT p.id, p.name, p.category, p.price\nFROM products p\nLEFT JOIN order_items oi ON p.id = oi.product_id\nWHERE oi.product_id != NULL",
    "generatedAt": "2026-01-11T06:05:14.145Z"
  },
  {
    "id": "q_1768111526199_cf5n82",
    "difficulty": "intermediate",
    "question": "Find the most expensive product purchased by each customer",
    "fingerprint": "customers-products-orders-max-group",
    "hint": "SELECT c.name, p.name AS product_name, MAX(oi.unit_price) AS max_price\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nGROUP BY c.id, c.name",
    "generatedAt": "2026-01-11T06:05:26.199Z"
  },
  {
    "id": "q_1768111537691_ixtfvz",
    "difficulty": "advanced",
    "question": "Find the product that generates the highest revenue per order across all completed orders",
    "fingerprint": "products-orders-revenue-max-completed",
    "hint": "SELECT p.name, p.id,\n       SUM(oi.quantity * oi.unit_price) as total_revenue,\n       COUNT(DISTINCT o.id) as order_count,\n       SUM(oi.quantity * oi.unit_price) / COUNT(DISTINCT o.id) as revenue_per_order\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nJOIN orders o ON oi.order_id = o.id\nWHERE o.status = 'completed'\nGROUP BY p.id, p.name\nORDER BY revenue_per_order DESC\nLIMIT 1;",
    "generatedAt": "2026-01-11T06:05:37.691Z"
  },
  {
    "id": "q_1768111548526_whcaaw",
    "difficulty": "advanced",
    "question": "Find customers who have ordered products from at least 3 different categories",
    "fingerprint": "customers-products-categories-count-min",
    "hint": "SELECT c.name, COUNT(DISTINCT p.category) as category_count\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nWHERE o.status = 'completed'\nGROUP BY c.id, c.name\nHAVING COUNT(DISTINCT p.category) >= 3",
    "generatedAt": "2026-01-11T06:05:48.526Z"
  },
  {
    "id": "q_1768111561351_i3xmxc",
    "difficulty": "advanced",
    "question": "Find customers who have ordered products from every available category",
    "fingerprint": "customers-products-categories-all-exists",
    "hint": "SELECT c.name, c.email\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nWHERE c.id IN (\n  SELECT customer_id\n  FROM orders o2\n  JOIN order_items oi2 ON o2.id = oi2.order_id\n  JOIN products p2 ON oi2.product_id = p2.id\n  GROUP BY customer_id\n  HAVING COUNT(DISTINCT p2.category) = (SELECT COUNT(*) FROM products)\n)\nGROUP BY c.id, c.name, c.email;",
    "generatedAt": "2026-01-11T06:06:01.351Z"
  },
  {
    "id": "q_1768111572386_n7brru",
    "difficulty": "advanced",
    "question": "Find the month with the highest total revenue from completed orders",
    "fingerprint": "orders-revenue-month-max-completed",
    "hint": "SELECT \n    EXTRACT(MONTH FROM order_date) as month,\n    SUM(total_amount) as total_revenue\nFROM orders \nWHERE status = 'completed'\nGROUP BY EXTRACT(MONTH FROM order_date)\nORDER BY total_revenue DESC;",
    "generatedAt": "2026-01-11T06:06:12.386Z"
  },
  {
    "id": "q_1768111583261_fmqmfi",
    "difficulty": "advanced",
    "question": "Find products that have been ordered by customers from at least three different regions",
    "fingerprint": "products-customers-regions-count-min",
    "hint": "SELECT p.name, p.category\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nJOIN orders o ON oi.order_id = o.id\nJOIN customers c ON o.customer_id = c.id\nGROUP BY p.id, p.name, p.category\nHAVING COUNT(DISTINCT c.region) >= 3",
    "generatedAt": "2026-01-11T06:06:23.261Z"
  },
  {
    "id": "q_1768111595352_6ddp9t",
    "difficulty": "advanced",
    "question": "Find products that have been ordered in fewer months than the average number of months across all products",
    "fingerprint": "products-orders-months-subaverage",
    "hint": "WITH product_months AS (\n    SELECT \n        p.id,\n        p.name,\n        COUNT(DISTINCT DATE_FORMAT(o.order_date, '%Y-%m')) as months_ordered\n    FROM products p\n    LEFT JOIN order_items oi ON p.id = oi.product_id\n    LEFT JOIN orders o ON oi.order_id = o.id\n    GROUP BY p.id, p.name\n),\navg_months AS (\n    SELECT AVG(months_ordered) as avg_months_per_product\n    FROM product_months\n    WHERE months_ordered > 0\n)\nSELECT pm.name, pm.months_ordered\nFROM product_months pm, avg_months am\nWHERE pm.months_ordered < am.avg_months_per_product\nORDER BY pm.months_ordered;",
    "generatedAt": "2026-01-11T06:06:35.352Z"
  },
  {
    "id": "q_1768111606956_cyocs0",
    "difficulty": "advanced",
    "question": "Find the first product each customer purchased from each category they have ordered from",
    "fingerprint": "customers-products-category-first-group",
    "hint": "SELECT DISTINCT c.name, p.category, p.name as first_product, o.order_date\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nWHERE o.order_date = (\n    SELECT MIN(o2.order_date)\n    FROM orders o2\n    JOIN order_items oi2 ON o2.id = oi2.order_id\n    JOIN products p2 ON oi2.product_id = p2.id\n    WHERE o2.customer_id = c.id\n    AND p2.category = p.category\n)\nORDER BY c.name, p.category;",
    "generatedAt": "2026-01-11T06:06:46.956Z"
  },
  {
    "id": "q_1768111618563_2341ak",
    "difficulty": "advanced",
    "question": "Find orders where every item ordered belongs to the same product category",
    "fingerprint": "orders-products-category-same-group",
    "hint": "SELECT DISTINCT o.id, o.customer_id, o.order_date, o.total_amount\nFROM orders o\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nWHERE o.id IN (\n    SELECT order_id\n    FROM order_items oi2\n    JOIN products p2 ON oi2.product_id = p2.id\n    GROUP BY order_id, p2.category\n    HAVING COUNT(DISTINCT p2.category) = 1\n)",
    "generatedAt": "2026-01-11T06:06:58.563Z"
  },
  {
    "id": "q_1768111629525_uxop0h",
    "difficulty": "advanced",
    "question": "Find customers who have ordered products from at least as many different categories as the customer who has ordered from the most categories",
    "fingerprint": "customers-products-categories-max-comparison",
    "hint": "WITH customer_categories AS (\n  SELECT c.id, c.name, COUNT(DISTINCT p.category) as category_count\n  FROM customers c\n  JOIN orders o ON c.id = o.customer_id\n  JOIN order_items oi ON o.id = oi.order_id\n  JOIN products p ON oi.product_id = p.id\n  WHERE o.status = 'completed'\n  GROUP BY c.id, c.name\n),\nmax_categories AS (\n  SELECT MAX(category_count) as max_count\n  FROM customer_categories\n)\nSELECT cc.name, cc.category_count\nFROM customer_categories cc\nCROSS JOIN max_categories mc\nWHERE cc.category_count = mc.max_count\nORDER BY cc.name;",
    "generatedAt": "2026-01-11T06:07:09.525Z"
  },
  {
    "id": "q_1768111640371_41a247",
    "difficulty": "advanced",
    "question": "Find the top-selling product in each region based on total quantity sold",
    "fingerprint": "products-regions-quantity-sum-group-top",
    "hint": "SELECT \n    c.region,\n    p.name,\n    SUM(oi.quantity) as total_quantity\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nWHERE o.status = 'completed'\nGROUP BY c.region, p.name\nORDER BY c.region, total_quantity DESC;",
    "generatedAt": "2026-01-11T06:07:20.371Z"
  }
]
