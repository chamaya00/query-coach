[
  {
    "id": "q_1768076194391_yatmhj",
    "difficulty": "beginner",
    "question": "Find all products in the Sports category",
    "hint": "SELECT name, price, stock_quantity \nFROM products \nWHERE category = 'Sport'",
    "generatedAt": "2026-01-10T20:16:34.391Z",
    "fingerprint": "products-category-equals"
  },
  {
    "id": "q_1768076199135_t60mla",
    "difficulty": "beginner",
    "question": "Find all products with a price less than $50",
    "hint": "SELECT name, price FROM products WHERE price <= 50;",
    "generatedAt": "2026-01-10T20:16:39.135Z",
    "fingerprint": "products-price-less-than"
  },
  {
    "id": "q_1768076203709_2w0qa3",
    "difficulty": "beginner",
    "question": "Show all products with a price less than $50",
    "hint": "SELECT name, price FROM products WHERE price <= 50;",
    "generatedAt": "2026-01-10T20:16:43.709Z",
    "fingerprint": "products-price-less-than"
  },
  {
    "id": "q_1768076208447_jxowc5",
    "difficulty": "beginner",
    "question": "Find all products in the Electronics category",
    "hint": "SELECT id, name, category, price \nFROM products \nWHERE category = 'Electronic'",
    "generatedAt": "2026-01-10T20:16:48.447Z",
    "fingerprint": "products-category-equals"
  },
  {
    "id": "q_1768076213279_c4gjch",
    "difficulty": "beginner",
    "question": "Find all products in the Sports category",
    "hint": "SELECT id, name, price \nFROM products \nWHERE category = 'Sport';",
    "generatedAt": "2026-01-10T20:16:53.279Z",
    "fingerprint": "products-category-equals"
  },
  {
    "id": "q_1768076218256_ky6d9h",
    "difficulty": "beginner",
    "question": "Find all products with a price less than $50",
    "hint": "SELECT name, price FROM products WHERE price <= 50;",
    "generatedAt": "2026-01-10T20:16:58.256Z",
    "fingerprint": "products-price-less-than"
  },
  {
    "id": "q_1768076222937_8ct2w7",
    "difficulty": "beginner",
    "question": "Find all products in the Sports category",
    "hint": "SELECT name, price FROM products WHERE category = 'Sport';",
    "generatedAt": "2026-01-10T20:17:02.937Z",
    "fingerprint": "products-category-equals"
  },
  {
    "id": "q_1768076228008_5vbrlv",
    "difficulty": "beginner",
    "question": "Find all products in the Sports category",
    "hint": "SELECT id, name, price, stock_quantity\nFROM products\nWHERE category = 'Sport';",
    "generatedAt": "2026-01-10T20:17:08.008Z",
    "fingerprint": "products-category-equals"
  },
  {
    "id": "q_1768076232615_mg82bb",
    "difficulty": "beginner",
    "question": "Find all products with a price less than $50",
    "hint": "SELECT name, price FROM products WHERE price <= 50;",
    "generatedAt": "2026-01-10T20:17:12.616Z",
    "fingerprint": "products-price-less-than"
  },
  {
    "id": "q_1768076237261_05a82e",
    "difficulty": "beginner",
    "question": "Find all products in the Sports category",
    "hint": "SELECT id, name, price \nFROM products \nWHERE category = 'Sport'",
    "generatedAt": "2026-01-10T20:17:17.261Z",
    "fingerprint": "products-category-equals"
  },
  {
    "id": "q_1768076245364_37v2o0",
    "difficulty": "intermediate",
    "question": "Find the average order value for each customer region",
    "hint": "SELECT c.region, AVG(o.total_amount) AS avg_order_value\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nWHERE o.status = 'completed'\nGROUP BY c.region",
    "generatedAt": "2026-01-10T20:17:25.364Z",
    "fingerprint": "customers-orders-region-avg-group"
  },
  {
    "id": "q_1768076255174_aucogk",
    "difficulty": "intermediate",
    "question": "Find all customers who have placed more than 2 orders",
    "hint": "SELECT c.name, COUNT(o.id) as order_count\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nWHERE COUNT(o.id) > 2\nGROUP BY c.name",
    "generatedAt": "2026-01-10T20:17:35.174Z",
    "fingerprint": "customers-orders-count-greater"
  },
  {
    "id": "q_1768076266500_24wioe",
    "difficulty": "intermediate",
    "question": "Find all customers who have placed orders with a total amount greater than $500",
    "hint": "SELECT c.name, c.email\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nWHERE o.total_amount > 500\nGROUP BY c.name, c.email",
    "generatedAt": "2026-01-10T20:17:46.500Z",
    "fingerprint": "customers-orders-amount-greater"
  },
  {
    "id": "q_1768076276871_1wqwco",
    "difficulty": "intermediate",
    "question": "Show the total quantity sold for each product category",
    "hint": "SELECT p.category, SUM(oi.quantity) as total_quantity\nFROM products p, order_items oi\nWHERE p.id = oi.product_id\nGROUP BY p.category",
    "generatedAt": "2026-01-10T20:17:56.871Z",
    "fingerprint": "products-category-quantity-sum-group"
  },
  {
    "id": "q_1768076286896_llk3as",
    "difficulty": "intermediate",
    "question": "Find the total quantity sold for each product category",
    "hint": "SELECT p.category, SUM(oi.quantity) as total_quantity\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nWHERE p.category IS NOT NULL\nGROUP BY p.category",
    "generatedAt": "2026-01-10T20:18:06.896Z",
    "fingerprint": "products-category-quantity-sum-group"
  },
  {
    "id": "q_1768076297347_ugnkvd",
    "difficulty": "intermediate",
    "question": "Find customers who have placed orders in both January and February 2024",
    "hint": "SELECT DISTINCT c.id, c.name\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nWHERE o.order_date >= '2024-01-01' \n  AND o.order_date < '2024-03-01'\nGROUP BY c.id, c.name\nHAVING COUNT(*) >= 2",
    "generatedAt": "2026-01-10T20:18:17.347Z",
    "fingerprint": "customers-orders-months-both-exists"
  },
  {
    "id": "q_1768076308417_ehwsis",
    "difficulty": "intermediate",
    "question": "Find the total revenue generated by each product category",
    "hint": "SELECT \n  p.category,\n  SUM(oi.quantity * oi.unit_price) AS total_revenue\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nWHERE o.status = 'completed'\nGROUP BY p.category\nORDER BY total_revenue DESC",
    "generatedAt": "2026-01-10T20:18:28.417Z",
    "fingerprint": "products-category-revenue-sum-group"
  },
  {
    "id": "q_1768076318323_0w1864",
    "difficulty": "intermediate",
    "question": "Find the total quantity sold for each product category",
    "hint": "SELECT p.category, SUM(oi.quantity) as total_quantity\nFROM products p, order_items oi\nWHERE p.id = oi.product_id\nGROUP BY p.category",
    "generatedAt": "2026-01-10T20:18:38.323Z",
    "fingerprint": "products-category-quantity-sum-group"
  },
  {
    "id": "q_1768076329894_x9yezw",
    "difficulty": "intermediate",
    "question": "Find all customers who have placed orders in both January and February 2024",
    "hint": "SELECT DISTINCT c.name, c.email\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nWHERE (o.order_date >= '2024-01-01' AND o.order_date < '2024-02-01')\n   OR (o.order_date >= '2024-02-01' AND o.order_date < '2024-03-01')",
    "generatedAt": "2026-01-10T20:18:49.894Z",
    "fingerprint": "customers-orders-months-both-exists"
  },
  {
    "id": "q_1768076339860_ibkzta",
    "difficulty": "intermediate",
    "question": "Find the total quantity of each product sold across all orders",
    "hint": "SELECT p.name, SUM(oi.quantity) as total_sold\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nWHERE p.stock_quantity > 0\nGROUP BY p.name",
    "generatedAt": "2026-01-10T20:18:59.860Z",
    "fingerprint": "products-orders-quantity-sum-group"
  },
  {
    "id": "q_1768076352317_ohexqm",
    "difficulty": "advanced",
    "question": "Find customers who have spent more on Electronics products than on all other categories combined",
    "hint": "WITH customer_spending AS (\n  SELECT \n    c.id,\n    c.name,\n    p.category,\n    SUM(oi.quantity * oi.unit_price) as category_spending\n  FROM customers c\n  JOIN orders o ON c.id = o.customer_id\n  JOIN order_items oi ON o.id = oi.order_id\n  JOIN products p ON oi.product_id = p.id\n  WHERE o.status = 'completed'\n  GROUP BY c.id, c.name, p.category\n),\nspending_comparison AS (\n  SELECT \n    id,\n    name,\n    SUM(CASE WHEN category = 'Electronics' THEN category_spending ELSE 0 END) as electronics_spending,\n    SUM(CASE WHEN category != 'Electronics' THEN category_spending ELSE 0 END) as other_spending\n  FROM customer_spending\n  GROUP BY id, name\n)\nSELECT id, name, electronics_spending, other_spending\nFROM spending_comparison\nWHERE electronics_spending > other_spending\nAND electronics_spending > 0;",
    "generatedAt": "2026-01-10T20:19:12.317Z",
    "fingerprint": "customers-products-electronics-category-compare-sum"
  },
  {
    "id": "q_1768076358986_e09rki",
    "difficulty": "advanced",
    "question": "Find products that have been purchased by customers from all three regions",
    "hint": "SELECT p.id, p.name\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nJOIN orders o ON oi.order_id = o.id\nJOIN customers c ON o.customer_id = c.id\nWHERE c.region IN ('West', 'East', 'Central')\nGROUP BY p.id, p.name\nHAVING COUNT(DISTINCT c.region) = 3;",
    "generatedAt": "2026-01-10T20:19:18.986Z",
    "fingerprint": "products-customers-regions-all-join"
  },
  {
    "id": "q_1768076369651_kiqii5",
    "difficulty": "advanced",
    "question": "Find products that have been ordered by customers from all three regions",
    "hint": "SELECT p.id, p.name\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nJOIN orders o ON oi.order_id = o.id\nJOIN customers c ON o.customer_id = c.id\nWHERE c.region IN ('West', 'East', 'Central')\nGROUP BY p.id, p.name\nHAVING COUNT(DISTINCT c.region) >= 3",
    "generatedAt": "2026-01-10T20:19:29.651Z",
    "fingerprint": "products-customers-regions-all-join"
  },
  {
    "id": "q_1768076380718_j0w981",
    "difficulty": "advanced",
    "question": "Find customers who have ordered products from at least 3 different categories",
    "hint": "WITH customer_categories AS (\n    SELECT \n        c.id,\n        c.name,\n        p.category\n    FROM customers c\n    JOIN orders o ON c.id = o.customer_id\n    JOIN order_items oi ON o.id = oi.order_id\n    JOIN products p ON oi.product_id = p.id\n    WHERE o.status = 'completed'\n    GROUP BY c.id, c.name, p.category\n),\ncategory_counts AS (\n    SELECT \n        id,\n        name,\n        COUNT(category) as category_count\n    FROM customer_categories\n    GROUP BY id, name\n)\nSELECT id, name\nFROM category_counts\nWHERE category_count >= 3;",
    "generatedAt": "2026-01-10T20:19:40.718Z",
    "fingerprint": "customers-products-categories-count-min"
  },
  {
    "id": "q_1768076394449_wtlpze",
    "difficulty": "advanced",
    "question": "Find customers who have placed orders in every month that any customer has placed an order",
    "hint": "WITH monthly_orders AS (\n    SELECT DISTINCT \n        strftime('%Y-%m', order_date) as order_month,\n        customer_id\n    FROM orders\n),\nall_months AS (\n    SELECT DISTINCT strftime('%Y-%m', order_date) as order_month\n    FROM orders\n),\ncustomer_month_counts AS (\n    SELECT \n        customer_id,\n        COUNT(DISTINCT order_month) as months_with_orders\n    FROM monthly_orders\n    GROUP BY customer_id\n),\ntotal_months AS (\n    SELECT COUNT(*) as total_month_count\n    FROM all_months\n)\nSELECT \n    c.id,\n    c.name\nFROM customers c\nJOIN customer_month_counts cmc ON c.id = cmc.customer_id\nWHERE cmc.months_with_orders = (SELECT total_month_count FROM total_months)",
    "generatedAt": "2026-01-10T20:19:54.449Z",
    "fingerprint": "customers-orders-months-all-division"
  },
  {
    "id": "q_1768076403863_trmpdp",
    "difficulty": "advanced",
    "question": "Find customers who have ordered from all product categories available in the store",
    "hint": "SELECT c.name, c.email\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nWHERE c.id IN (\n    SELECT customer_id\n    FROM orders o2\n    JOIN order_items oi2 ON o2.id = oi2.order_id\n    JOIN products p2 ON oi2.product_id = p2.id\n    GROUP BY customer_id\n    HAVING COUNT(DISTINCT p2.category) = (\n        SELECT COUNT(DISTINCT category) FROM products\n    )\n)\nGROUP BY c.id, c.name, c.email;",
    "generatedAt": "2026-01-10T20:20:03.863Z",
    "fingerprint": "customers-categories-all-exists"
  },
  {
    "id": "q_1768076413714_c9chtc",
    "difficulty": "advanced",
    "question": "Find customers who have ordered products from at least 3 different categories",
    "hint": "SELECT c.id, c.name\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nGROUP BY c.id, c.name\nHAVING COUNT(DISTINCT p.category) >= 3",
    "generatedAt": "2026-01-10T20:20:13.714Z",
    "fingerprint": "customers-products-categories-count-having"
  },
  {
    "id": "q_1768076424372_6nsafp",
    "difficulty": "advanced",
    "question": "Find customers who have ordered products from at least three different categories",
    "hint": "SELECT c.id, c.name\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nGROUP BY c.id, c.name\nHAVING COUNT(p.category) >= 3",
    "generatedAt": "2026-01-10T20:20:24.372Z",
    "fingerprint": "customers-products-categories-count-min"
  },
  {
    "id": "q_1768076434640_zfb422",
    "difficulty": "advanced",
    "question": "Find customers who have ordered products from at least 3 different categories",
    "hint": "SELECT c.name, c.email\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nGROUP BY c.id, c.name, c.email\nHAVING COUNT(p.category) >= 3",
    "generatedAt": "2026-01-10T20:20:34.640Z",
    "fingerprint": "customers-products-categories-count-threshold"
  },
  {
    "id": "q_1768076444944_poi01l",
    "difficulty": "advanced",
    "question": "Find customers who have ordered products from at least 3 different categories",
    "hint": "SELECT c.id, c.name\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nGROUP BY c.id, c.name\nHAVING COUNT(p.category) >= 3",
    "generatedAt": "2026-01-10T20:20:44.944Z",
    "fingerprint": "customers-products-categories-count-min"
  },
  {
    "id": "q_1768111363947_gfi35k",
    "difficulty": "beginner",
    "question": "Find all customers who joined in 2023",
    "fingerprint": "customers-joined-year-equals",
    "hint": "SELECT name, email, region, created_date\nFROM customers\nWHERE created_at >= '2023-01-01' AND created_at < '2024-01-01';",
    "generatedAt": "2026-01-11T06:02:43.947Z"
  },
  {
    "id": "q_1768111371064_dwmeig",
    "difficulty": "beginner",
    "question": "Find all orders with a total amount greater than 200",
    "fingerprint": "orders-total-greater",
    "hint": "SELECT id, customer_id, order_date, status, total_amount\nFROM orders\nWHERE total_amount > 200.00",
    "generatedAt": "2026-01-11T06:02:51.064Z"
  },
  {
    "id": "q_1768111378750_0bx08g",
    "difficulty": "beginner",
    "question": "Find all products with stock quantity greater than 100",
    "fingerprint": "products-stock-greater",
    "hint": "SELECT name, category, price, stock_qty \nFROM products \nWHERE stock_quantity > 100;",
    "generatedAt": "2026-01-11T06:02:58.750Z"
  },
  {
    "id": "q_1768111386275_1ois5e",
    "difficulty": "beginner",
    "question": "Find all orders with a status of 'shipped'",
    "fingerprint": "orders-status-equals",
    "hint": "SELECT * FROM orders WHERE status = 'ship'",
    "generatedAt": "2026-01-11T06:03:06.275Z"
  },
  {
    "id": "q_1768111393630_d49izl",
    "difficulty": "beginner",
    "question": "Find all customers who created their account in 2023",
    "fingerprint": "customers-created-year-equals",
    "hint": "SELECT name, email, region FROM customers WHERE created_at LIKE '2023%'",
    "generatedAt": "2026-01-11T06:03:13.630Z"
  },
  {
    "id": "q_1768111401448_c0chkr",
    "difficulty": "beginner",
    "question": "Show all customers who joined in 2023",
    "fingerprint": "customers-joined-2023-equals",
    "hint": "SELECT id, name, email, region, created_at\nFROM customers\nWHERE created_at LIKE '2023%'",
    "generatedAt": "2026-01-11T06:03:21.448Z"
  },
  {
    "id": "q_1768111408878_3tu63h",
    "difficulty": "beginner",
    "question": "Find all products with stock quantity greater than 100",
    "fingerprint": "products-stock-greater",
    "hint": "SELECT name, category, price, stock_qty \nFROM products \nWHERE stock_quantity > 100",
    "generatedAt": "2026-01-11T06:03:28.878Z"
  },
  {
    "id": "q_1768111416108_tgn8at",
    "difficulty": "beginner",
    "question": "Find all orders with a total amount greater than 100",
    "fingerprint": "orders-total-greater",
    "hint": "SELECT id, customer_id, order_date, status, total_amount\nFROM orders\nWHERE total_amount > 100.00",
    "generatedAt": "2026-01-11T06:03:36.108Z"
  },
  {
    "id": "q_1768111423231_680rmz",
    "difficulty": "beginner",
    "question": "Show all orders placed in February 2024",
    "fingerprint": "orders-date-february",
    "hint": "SELECT id, customer_id, order_date, status, total_amount\nFROM orders\nWHERE order_date >= '2024-02-01' AND order_date < '2024-03-01'",
    "generatedAt": "2026-01-11T06:03:43.231Z"
  },
  {
    "id": "q_1768111431227_ns3o96",
    "difficulty": "beginner",
    "question": "Find the 3 cheapest products in the database",
    "fingerprint": "products-price-order-limit",
    "hint": "SELECT name, price FROM products ORDER BY price LIMIT 3;",
    "generatedAt": "2026-01-11T06:03:51.227Z"
  },
  {
    "id": "q_1768111438916_1q2h18",
    "difficulty": "intermediate",
    "question": "Find products that have been ordered more than twice",
    "fingerprint": "products-orders-count-greater",
    "hint": "SELECT p.id, p.name, COUNT(oi.product_id) as order_count\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nWHERE COUNT(oi.product_id) > 2\nGROUP BY p.id, p.name\nORDER BY order_count DESC",
    "generatedAt": "2026-01-11T06:03:58.916Z"
  },
  {
    "id": "q_1768111447118_gqq76s",
    "difficulty": "intermediate",
    "question": "Show the average order value for each order status",
    "fingerprint": "orders-status-avg-group",
    "hint": "SELECT status, AVG(total_amount) as average_order_value\nFROM orders\nGROUP BY status\nHAVING COUNT(*) > 2",
    "generatedAt": "2026-01-11T06:04:07.118Z"
  },
  {
    "id": "q_1768111454430_ompyb7",
    "difficulty": "intermediate",
    "question": "Find products that have been ordered more than twice",
    "fingerprint": "products-orders-count-greater",
    "hint": "SELECT p.name, COUNT(oi.product_id) as order_count\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nWHERE COUNT(oi.product_id) > 2\nGROUP BY p.name",
    "generatedAt": "2026-01-11T06:04:14.430Z"
  },
  {
    "id": "q_1768111462061_g2gg2v",
    "difficulty": "intermediate",
    "question": "Find products that have been ordered by customers from at least two different regions",
    "fingerprint": "products-customers-regions-count-min",
    "hint": "SELECT DISTINCT p.name\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nJOIN orders o ON oi.order_id = o.id\nJOIN customers c ON o.customer_id = c.id\nGROUP BY p.name\nHAVING COUNT(DISTINCT c.region) >= 2",
    "generatedAt": "2026-01-11T06:04:22.061Z"
  },
  {
    "id": "q_1768111469899_uh17rp",
    "difficulty": "intermediate",
    "question": "Find products that have been ordered by customers from at least two different regions",
    "fingerprint": "products-customers-regions-count-min",
    "hint": "SELECT p.id, p.name\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nJOIN orders o ON oi.order_id = o.id\nJOIN customers c ON o.customer_id = c.id\nGROUP BY p.id, p.name\nHAVING COUNT(c.region) >= 2",
    "generatedAt": "2026-01-11T06:04:29.899Z"
  },
  {
    "id": "q_1768111480737_6a6h49",
    "difficulty": "intermediate",
    "question": "Find all products that have never been ordered",
    "fingerprint": "products-orders-not-exists",
    "hint": "SELECT p.name, p.category, p.price\nFROM products p\nLEFT JOIN order_items oi ON p.id = oi.product_id\nWHERE oi.product_id IS NULL\nGROUP BY p.id, p.name, p.category, p.price",
    "generatedAt": "2026-01-11T06:04:40.737Z"
  },
  {
    "id": "q_1768111490977_qc3app",
    "difficulty": "intermediate",
    "question": "Find products that have been ordered by customers from at least 2 different regions",
    "fingerprint": "products-customers-regions-count-atleast",
    "hint": "SELECT p.name\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nJOIN orders o ON oi.order_id = o.id\nJOIN customers c ON o.customer_id = c.id\nGROUP BY p.id, p.name\nHAVING COUNT(c.region) >= 2",
    "generatedAt": "2026-01-11T06:04:50.977Z"
  },
  {
    "id": "q_1768111503051_rbrenp",
    "difficulty": "intermediate",
    "question": "Find customers who have spent more than $500 total across all their orders",
    "fingerprint": "customers-orders-total-greater",
    "hint": "SELECT c.name, SUM(o.total_amount) as total_spent\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nWHERE SUM(o.total_amount) > 500\nGROUP BY c.id, c.name",
    "generatedAt": "2026-01-11T06:05:03.051Z"
  },
  {
    "id": "q_1768111514145_ljdgym",
    "difficulty": "intermediate",
    "question": "Show all products that have never been ordered",
    "fingerprint": "products-orders-not-exists",
    "hint": "SELECT p.id, p.name, p.category, p.price\nFROM products p\nLEFT JOIN order_items oi ON p.id = oi.product_id\nWHERE oi.product_id != NULL",
    "generatedAt": "2026-01-11T06:05:14.145Z"
  },
  {
    "id": "q_1768111526199_cf5n82",
    "difficulty": "intermediate",
    "question": "Find the most expensive product purchased by each customer",
    "fingerprint": "customers-products-orders-max-group",
    "hint": "SELECT c.name, p.name AS product_name, MAX(oi.unit_price) AS max_price\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nGROUP BY c.id, c.name",
    "generatedAt": "2026-01-11T06:05:26.199Z"
  },
  {
    "id": "q_1768111537691_ixtfvz",
    "difficulty": "advanced",
    "question": "Find the product that generates the highest revenue per order across all completed orders",
    "fingerprint": "products-orders-revenue-max-completed",
    "hint": "SELECT p.name, p.id,\n       SUM(oi.quantity * oi.unit_price) as total_revenue,\n       COUNT(DISTINCT o.id) as order_count,\n       SUM(oi.quantity * oi.unit_price) / COUNT(DISTINCT o.id) as revenue_per_order\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nJOIN orders o ON oi.order_id = o.id\nWHERE o.status = 'completed'\nGROUP BY p.id, p.name\nORDER BY revenue_per_order DESC\nLIMIT 1;",
    "generatedAt": "2026-01-11T06:05:37.691Z"
  },
  {
    "id": "q_1768111548526_whcaaw",
    "difficulty": "advanced",
    "question": "Find customers who have ordered products from at least 3 different categories",
    "fingerprint": "customers-products-categories-count-min",
    "hint": "SELECT c.name, COUNT(DISTINCT p.category) as category_count\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nWHERE o.status = 'completed'\nGROUP BY c.id, c.name\nHAVING COUNT(DISTINCT p.category) >= 3",
    "generatedAt": "2026-01-11T06:05:48.526Z"
  },
  {
    "id": "q_1768111561351_i3xmxc",
    "difficulty": "advanced",
    "question": "Find customers who have ordered products from every available category",
    "fingerprint": "customers-products-categories-all-exists",
    "hint": "SELECT c.name, c.email\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nWHERE c.id IN (\n  SELECT customer_id\n  FROM orders o2\n  JOIN order_items oi2 ON o2.id = oi2.order_id\n  JOIN products p2 ON oi2.product_id = p2.id\n  GROUP BY customer_id\n  HAVING COUNT(DISTINCT p2.category) = (SELECT COUNT(*) FROM products)\n)\nGROUP BY c.id, c.name, c.email;",
    "generatedAt": "2026-01-11T06:06:01.351Z"
  },
  {
    "id": "q_1768111572386_n7brru",
    "difficulty": "advanced",
    "question": "Find the month with the highest total revenue from completed orders",
    "fingerprint": "orders-revenue-month-max-completed",
    "hint": "SELECT \n    EXTRACT(MONTH FROM order_date) as month,\n    SUM(total_amount) as total_revenue\nFROM orders \nWHERE status = 'completed'\nGROUP BY EXTRACT(MONTH FROM order_date)\nORDER BY total_revenue DESC;",
    "generatedAt": "2026-01-11T06:06:12.386Z"
  },
  {
    "id": "q_1768111583261_fmqmfi",
    "difficulty": "advanced",
    "question": "Find products that have been ordered by customers from at least three different regions",
    "fingerprint": "products-customers-regions-count-min",
    "hint": "SELECT p.name, p.category\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nJOIN orders o ON oi.order_id = o.id\nJOIN customers c ON o.customer_id = c.id\nGROUP BY p.id, p.name, p.category\nHAVING COUNT(DISTINCT c.region) >= 3",
    "generatedAt": "2026-01-11T06:06:23.261Z"
  },
  {
    "id": "q_1768111595352_6ddp9t",
    "difficulty": "advanced",
    "question": "Find products that have been ordered in fewer months than the average number of months across all products",
    "fingerprint": "products-orders-months-subaverage",
    "hint": "WITH product_months AS (\n    SELECT \n        p.id,\n        p.name,\n        COUNT(DISTINCT DATE_FORMAT(o.order_date, '%Y-%m')) as months_ordered\n    FROM products p\n    LEFT JOIN order_items oi ON p.id = oi.product_id\n    LEFT JOIN orders o ON oi.order_id = o.id\n    GROUP BY p.id, p.name\n),\navg_months AS (\n    SELECT AVG(months_ordered) as avg_months_per_product\n    FROM product_months\n    WHERE months_ordered > 0\n)\nSELECT pm.name, pm.months_ordered\nFROM product_months pm, avg_months am\nWHERE pm.months_ordered < am.avg_months_per_product\nORDER BY pm.months_ordered;",
    "generatedAt": "2026-01-11T06:06:35.352Z"
  },
  {
    "id": "q_1768111606956_cyocs0",
    "difficulty": "advanced",
    "question": "Find the first product each customer purchased from each category they have ordered from",
    "fingerprint": "customers-products-category-first-group",
    "hint": "SELECT DISTINCT c.name, p.category, p.name as first_product, o.order_date\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nWHERE o.order_date = (\n    SELECT MIN(o2.order_date)\n    FROM orders o2\n    JOIN order_items oi2 ON o2.id = oi2.order_id\n    JOIN products p2 ON oi2.product_id = p2.id\n    WHERE o2.customer_id = c.id\n    AND p2.category = p.category\n)\nORDER BY c.name, p.category;",
    "generatedAt": "2026-01-11T06:06:46.956Z"
  },
  {
    "id": "q_1768111618563_2341ak",
    "difficulty": "advanced",
    "question": "Find orders where every item ordered belongs to the same product category",
    "fingerprint": "orders-products-category-same-group",
    "hint": "SELECT DISTINCT o.id, o.customer_id, o.order_date, o.total_amount\nFROM orders o\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nWHERE o.id IN (\n    SELECT order_id\n    FROM order_items oi2\n    JOIN products p2 ON oi2.product_id = p2.id\n    GROUP BY order_id, p2.category\n    HAVING COUNT(DISTINCT p2.category) = 1\n)",
    "generatedAt": "2026-01-11T06:06:58.563Z"
  },
  {
    "id": "q_1768111629525_uxop0h",
    "difficulty": "advanced",
    "question": "Find customers who have ordered products from at least as many different categories as the customer who has ordered from the most categories",
    "fingerprint": "customers-products-categories-max-comparison",
    "hint": "WITH customer_categories AS (\n  SELECT c.id, c.name, COUNT(DISTINCT p.category) as category_count\n  FROM customers c\n  JOIN orders o ON c.id = o.customer_id\n  JOIN order_items oi ON o.id = oi.order_id\n  JOIN products p ON oi.product_id = p.id\n  WHERE o.status = 'completed'\n  GROUP BY c.id, c.name\n),\nmax_categories AS (\n  SELECT MAX(category_count) as max_count\n  FROM customer_categories\n)\nSELECT cc.name, cc.category_count\nFROM customer_categories cc\nCROSS JOIN max_categories mc\nWHERE cc.category_count = mc.max_count\nORDER BY cc.name;",
    "generatedAt": "2026-01-11T06:07:09.525Z"
  },
  {
    "id": "q_1768111640371_41a247",
    "difficulty": "advanced",
    "question": "Find the top-selling product in each region based on total quantity sold",
    "fingerprint": "products-regions-quantity-sum-group-top",
    "hint": "SELECT \n    c.region,\n    p.name,\n    SUM(oi.quantity) as total_quantity\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nWHERE o.status = 'completed'\nGROUP BY c.region, p.name\nORDER BY c.region, total_quantity DESC;",
    "generatedAt": "2026-01-11T06:07:20.371Z"
  },
  {
    "id": "q_1768112887427_3a0zkp",
    "difficulty": "beginner",
    "question": "Find all products with stock quantity less than 100",
    "fingerprint": "products-stock-less-than",
    "hint": "SELECT name, category, price, stock_quantity \nFROM products \nWHERE stock_quantity <= 100;",
    "generatedAt": "2026-01-11T06:28:07.427Z"
  },
  {
    "id": "q_1768112895451_wnzkw4",
    "difficulty": "beginner",
    "question": "Count how many orders have a status of 'shipped'",
    "fingerprint": "orders-status-equals-count",
    "hint": "SELECT COUNT(*) FROM orders WHERE status = 'shipping'",
    "generatedAt": "2026-01-11T06:28:15.451Z"
  },
  {
    "id": "q_1768112903046_swtk8j",
    "difficulty": "beginner",
    "question": "Show all products with stock quantity above 100",
    "fingerprint": "products-stock-above",
    "hint": "SELECT name, category, price, stock_qty\nFROM products\nWHERE stock_quantity > 100;",
    "generatedAt": "2026-01-11T06:28:23.046Z"
  },
  {
    "id": "q_1768112910605_3om83m",
    "difficulty": "beginner",
    "question": "Find all customers who joined in January 2023",
    "fingerprint": "customers-joined-date-equals",
    "hint": "SELECT name, email, region, created_at\nFROM customers\nWHERE created_at >= '2023-01-01' AND created_at < '2023-02-01'",
    "generatedAt": "2026-01-11T06:28:30.605Z"
  },
  {
    "id": "q_1768112918309_76lue3",
    "difficulty": "beginner",
    "question": "Find all products with a price between 50 and 100 dollars",
    "fingerprint": "products-price-between",
    "hint": "SELECT name, price FROM products WHERE price > 50 AND price < 100",
    "generatedAt": "2026-01-11T06:28:38.309Z"
  },
  {
    "id": "q_1768112926869_alunfu",
    "difficulty": "beginner",
    "question": "Find all customers who created their account in February 2023",
    "fingerprint": "customers-created-date-month-equals",
    "hint": "SELECT name, email, region \nFROM customers \nWHERE created_at >= '2023-02-01' AND created_at < '2023-03-01'",
    "generatedAt": "2026-01-11T06:28:46.869Z"
  },
  {
    "id": "q_1768112935076_p6jpa9",
    "difficulty": "beginner",
    "question": "Find all customers who joined before March 2023",
    "fingerprint": "customers-joindate-before",
    "hint": "SELECT name, email, region, created_at\nFROM customers\nWHERE created_at < '2023-03-01'\nORDER BY created_date;",
    "generatedAt": "2026-01-11T06:28:55.076Z"
  },
  {
    "id": "q_1768112942969_t5hmwu",
    "difficulty": "beginner",
    "question": "Find all customers with email addresses containing 'email.com'",
    "fingerprint": "customers-email-contains",
    "hint": "SELECT name, email FROM customers WHERE email LIKE '%email.com'",
    "generatedAt": "2026-01-11T06:29:02.969Z"
  },
  {
    "id": "q_1768112950003_vnb12u",
    "difficulty": "beginner",
    "question": "Find all orders with a total amount above 100",
    "fingerprint": "orders-total-above",
    "hint": "SELECT id, customer_id, order_date, status, total_amount\nFROM orders\nWHERE total_amount >= 100",
    "generatedAt": "2026-01-11T06:29:10.003Z"
  },
  {
    "id": "q_1768112958257_4fd1s6",
    "difficulty": "beginner",
    "question": "Show all products that are currently out of stock",
    "fingerprint": "products-stock-equals",
    "hint": "SELECT name, category, price, stock_quantity \nFROM products \nWHERE stock_quantity = 0",
    "generatedAt": "2026-01-11T06:29:18.257Z"
  },
  {
    "id": "q_1768112966911_8bc2at",
    "difficulty": "beginner",
    "question": "Find all orders with a shipped status",
    "fingerprint": "orders-status-equals",
    "hint": "SELECT * FROM orders WHERE status = 'ship'",
    "generatedAt": "2026-01-11T06:29:26.911Z"
  },
  {
    "id": "q_1768112973943_qdi0mx",
    "difficulty": "beginner",
    "question": "Find all customers who created their account in March 2023",
    "fingerprint": "customers-created-date-month",
    "hint": "SELECT name, email, region \nFROM customers \nWHERE created_at >= '2023-03-01' AND created_at < '2023-04-01'",
    "generatedAt": "2026-01-11T06:29:33.943Z"
  },
  {
    "id": "q_1768112983286_18ee08",
    "difficulty": "beginner",
    "question": "Show the first 3 customers ordered by name alphabetically",
    "fingerprint": "customers-name-order-limit",
    "hint": "SELECT id, name, email, region, created_at\nFROM customers\nORDER BY customer_name\nLIMIT 3",
    "generatedAt": "2026-01-11T06:29:43.286Z"
  },
  {
    "id": "q_1768112991386_t2oeuu",
    "difficulty": "beginner",
    "question": "Find all products with a stock quantity below 100",
    "fingerprint": "products-stock-below",
    "hint": "SELECT name, category, price, stock_quantity\nFROM products\nWHERE stock_quantity <= 100",
    "generatedAt": "2026-01-11T06:29:51.386Z"
  },
  {
    "id": "q_1768112999151_ocqqn6",
    "difficulty": "beginner",
    "question": "Find all products with a unit price above $50",
    "fingerprint": "products-price-above",
    "hint": "SELECT name, unit_price\nFROM products\nWHERE unit_price > 50;",
    "generatedAt": "2026-01-11T06:29:59.151Z"
  },
  {
    "id": "q_1768113006926_qsbeji",
    "difficulty": "beginner",
    "question": "Find all products with stock quantity greater than 100",
    "fingerprint": "products-stock-greater",
    "hint": "SELECT name, category, price, stock_qty\nFROM products\nWHERE stock_quantity > 100;",
    "generatedAt": "2026-01-11T06:30:06.926Z"
  },
  {
    "id": "q_1768113018655_rm7a0s",
    "difficulty": "beginner",
    "question": "Find all products in the Appliances category",
    "fingerprint": "products-category-equals",
    "hint": "SELECT name, price \nFROM products \nWHERE category = 'Appliance';",
    "generatedAt": "2026-01-11T06:30:18.655Z"
  },
  {
    "id": "q_1768113029516_0vaqna",
    "difficulty": "beginner",
    "question": "Find all products with more than 100 items in stock",
    "fingerprint": "products-stock-greater",
    "hint": "SELECT name, category, price, stock_quantity FROM products WHERE stock_quantity >= 100;",
    "generatedAt": "2026-01-11T06:30:29.516Z"
  },
  {
    "id": "q_1768113042726_jbclgy",
    "difficulty": "beginner",
    "question": "Find all customers who joined in February 2023",
    "fingerprint": "customers-joindate-month-year",
    "hint": "SELECT id, name, email, region, created_at\nFROM customers\nWHERE created_at LIKE '2023-02%'",
    "generatedAt": "2026-01-11T06:30:42.726Z"
  },
  {
    "id": "q_1768113052144_1va7g9",
    "difficulty": "beginner",
    "question": "Show all orders placed in January 2024",
    "fingerprint": "orders-date-january-filter",
    "hint": "SELECT * FROM orders WHERE order_date LIKE '2024-01%'",
    "generatedAt": "2026-01-11T06:30:52.144Z"
  },
  {
    "id": "q_1768113063863_c4um4c",
    "difficulty": "intermediate",
    "question": "Find products that have been ordered more than twice",
    "fingerprint": "products-orders-count-greater",
    "hint": "SELECT p.name, COUNT(oi.product_id) as order_count\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nWHERE COUNT(oi.product_id) > 2\nGROUP BY p.name",
    "generatedAt": "2026-01-11T06:31:03.863Z"
  },
  {
    "id": "q_1768113077078_q5qiql",
    "difficulty": "intermediate",
    "question": "Find products that have been ordered more than twice",
    "fingerprint": "products-orders-count-greater",
    "hint": "SELECT p.name, COUNT(oi.product_id) as order_count\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nWHERE COUNT(oi.product_id) > 2\nGROUP BY p.name",
    "generatedAt": "2026-01-11T06:31:17.078Z"
  },
  {
    "id": "q_1768113088228_2hnonj",
    "difficulty": "intermediate",
    "question": "Find the most expensive product purchased by customers from each region",
    "fingerprint": "products-customers-region-price-max-group",
    "hint": "SELECT c.region, p.name, p.price\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nWHERE p.price = (\n    SELECT MAX(p2.price)\n    FROM customers c2\n    JOIN orders o2 ON c2.id = o2.customer_id\n    JOIN order_items oi2 ON o2.id = oi2.order_id\n    JOIN products p2 ON oi2.product_id = p2.id\n    WHERE c2.region = c.region\n)",
    "generatedAt": "2026-01-11T06:31:28.228Z"
  },
  {
    "id": "q_1768113098969_nggpl5",
    "difficulty": "intermediate",
    "question": "Find products that have been ordered by customers from at least 2 different regions",
    "fingerprint": "products-customers-regions-count-min",
    "hint": "SELECT DISTINCT p.id, p.name\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nJOIN orders o ON oi.order_id = o.id\nJOIN customers c ON o.customer_id = c.id\nWHERE c.region IS NOT NULL\nGROUP BY p.id, p.name\nHAVING COUNT(c.region) >= 2",
    "generatedAt": "2026-01-11T06:31:38.969Z"
  },
  {
    "id": "q_1768113110678_lv5o8t",
    "difficulty": "intermediate",
    "question": "Find products that have been ordered by customers from at least 2 different regions",
    "fingerprint": "products-customers-regions-count-min",
    "hint": "SELECT DISTINCT p.name\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nJOIN orders o ON oi.order_id = o.id\nJOIN customers c ON o.customer_id = c.id\nWHERE c.region IS NOT NULL\nGROUP BY p.id, p.name\nHAVING COUNT(c.region) >= 2",
    "generatedAt": "2026-01-11T06:31:50.678Z"
  },
  {
    "id": "q_1768113121728_nverc8",
    "difficulty": "intermediate",
    "question": "Find the average order value for each customer region",
    "fingerprint": "customers-orders-region-avg-group",
    "hint": "SELECT c.region, AVG(o.total_amount) as avg_order_value\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nWHERE o.status = 'completed'\nGROUP BY c.region;",
    "generatedAt": "2026-01-11T06:32:01.728Z"
  },
  {
    "id": "q_1768113134008_o04mn1",
    "difficulty": "intermediate",
    "question": "Find the most popular product category based on total quantity sold",
    "fingerprint": "products-category-quantity-sum-max",
    "hint": "SELECT p.category, SUM(oi.quantity) as total_sold\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nWHERE total_sold = (SELECT MAX(total_sold) FROM (\n    SELECT SUM(oi.quantity) as total_sold\n    FROM products p\n    JOIN order_items oi ON p.id = oi.product_id\n    GROUP BY p.category\n))\nGROUP BY p.category",
    "generatedAt": "2026-01-11T06:32:14.008Z"
  },
  {
    "id": "q_1768113145751_c1pw8x",
    "difficulty": "intermediate",
    "question": "Find customers who have made purchases in both January and February 2024",
    "fingerprint": "customers-purchases-months-both",
    "hint": "SELECT DISTINCT c.id, c.name\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nWHERE (o.order_date >= '2024-01-01' AND o.order_date < '2024-02-01')\n   OR (o.order_date >= '2024-02-01' AND o.order_date < '2024-03-01')\nGROUP BY c.id, c.name\nHAVING COUNT(DISTINCT EXTRACT(MONTH FROM o.order_date)) = 2",
    "generatedAt": "2026-01-11T06:32:25.751Z"
  },
  {
    "id": "q_1768113156423_c9vb83",
    "difficulty": "intermediate",
    "question": "Find customers who have placed orders in both January and February 2024",
    "fingerprint": "customers-orders-months-both-exists",
    "hint": "SELECT DISTINCT c.name, c.email\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nWHERE (o.order_date >= '2024-01-01' AND o.order_date < '2024-02-01')\n   OR (o.order_date >= '2024-02-01' AND o.order_date < '2024-03-01')",
    "generatedAt": "2026-01-11T06:32:36.423Z"
  },
  {
    "id": "q_1768113168337_yyp8h2",
    "difficulty": "intermediate",
    "question": "Find the average order value for each order status",
    "fingerprint": "orders-status-avg-group",
    "hint": "SELECT status, AVG(total_amount) as avg_order_value\nFROM orders\nWHERE status IN ('completed', 'pending', 'shipped')\nGROUP BY status\nHAVING AVG(total_amount) > 0",
    "generatedAt": "2026-01-11T06:32:48.337Z"
  },
  {
    "id": "q_1768113179920_0on35h",
    "difficulty": "intermediate",
    "question": "Find customers who have ordered products from at least 2 different categories",
    "fingerprint": "customers-products-categories-count-minimum",
    "hint": "SELECT c.id, c.name\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nGROUP BY c.id, c.name\nHAVING COUNT(p.category) >= 2",
    "generatedAt": "2026-01-11T06:32:59.920Z"
  },
  {
    "id": "q_1768113192129_fam8ke",
    "difficulty": "intermediate",
    "question": "Find the most popular product in each category based on total quantity sold",
    "fingerprint": "products-category-quantity-max-group",
    "hint": "SELECT p.category, p.name, SUM(oi.quantity) as total_sold\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nJOIN orders o ON oi.order_id = o.id\nWHERE o.status = 'completed'\nGROUP BY p.category\nORDER BY p.category, total_sold DESC",
    "generatedAt": "2026-01-11T06:33:12.129Z"
  },
  {
    "id": "q_1768113204085_lb4zjq",
    "difficulty": "intermediate",
    "question": "Find the average order value for each order status",
    "fingerprint": "orders-status-avg-group",
    "hint": "SELECT status, AVG(total_amount) AS average_order_value\nFROM orders\nWHERE status IN ('completed', 'shipped', 'pending')\nGROUP BY status\nHAVING AVG(total_amount) > 0;",
    "generatedAt": "2026-01-11T06:33:24.085Z"
  },
  {
    "id": "q_1768113220971_uotqdq",
    "difficulty": "intermediate",
    "question": "Find the most popular product in each category based on total quantity sold",
    "fingerprint": "products-category-quantity-max-group",
    "hint": "SELECT p.category, p.name, SUM(oi.quantity) as total_sold\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nGROUP BY p.category\nORDER BY total_sold DESC;",
    "generatedAt": "2026-01-11T06:33:40.971Z"
  },
  {
    "id": "q_1768113228827_5opj3x",
    "difficulty": "intermediate",
    "question": "Find the average order value for each month in 2024",
    "fingerprint": "orders-month-2024-avg-group",
    "hint": "SELECT \n    EXTRACT(MONTH FROM order_date) as month,\n    AVG(total_amount) as avg_order_value\nFROM orders\nWHERE EXTRACT(YEAR FROM order_date) = 2024\nGROUP BY EXTRACT(MONTH FROM order_date);",
    "generatedAt": "2026-01-11T06:33:48.827Z"
  },
  {
    "id": "q_1768113239876_cbmy7g",
    "difficulty": "intermediate",
    "question": "Find the most expensive product in each category",
    "fingerprint": "products-category-price-max-group",
    "hint": "SELECT p.category, p.name, p.price\nFROM products p\nJOIN (\n    SELECT category, MAX(price) as max_price\n    FROM products\n    GROUP BY category\n) max_prices ON p.category = max_prices.category\nWHERE p.price = max_prices.max_price;",
    "generatedAt": "2026-01-11T06:33:59.876Z"
  },
  {
    "id": "q_1768113250938_qkxzce",
    "difficulty": "intermediate",
    "question": "Find the email addresses of customers who have ordered products from at least two different categories",
    "fingerprint": "customers-products-categories-email-multiple",
    "hint": "SELECT DISTINCT c.email\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nWHERE c.id IN (\n    SELECT customer_id\n    FROM orders o2\n    JOIN order_items oi2 ON o2.id = oi2.order_id\n    JOIN products p2 ON oi2.product_id = p2.id\n    GROUP BY customer_id\n    HAVING COUNT(p2.category) >= 2\n)",
    "generatedAt": "2026-01-11T06:34:10.938Z"
  },
  {
    "id": "q_1768113262204_plpoyt",
    "difficulty": "intermediate",
    "question": "Find products that appear in more than 2 different orders",
    "fingerprint": "products-orders-count-greater",
    "hint": "SELECT p.name, COUNT(o.id) as order_count\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nJOIN orders o ON oi.order_id = o.id\nGROUP BY p.name\nHAVING COUNT(o.id) > 2",
    "generatedAt": "2026-01-11T06:34:22.204Z"
  },
  {
    "id": "q_1768113274381_e4vrqg",
    "difficulty": "intermediate",
    "question": "Find the most expensive product purchased by customers in each region",
    "fingerprint": "products-customers-region-price-max-group",
    "hint": "SELECT \n    c.region,\n    p.name AS product_name,\n    p.price\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nWHERE p.price = (\n    SELECT MAX(p2.price)\n    FROM customers c2\n    JOIN orders o2 ON c2.id = o2.customer_id\n    JOIN order_items oi2 ON o2.id = oi2.order_id\n    JOIN products p2 ON oi2.product_id = p2.id\n    WHERE c2.region = c.region\n)\nGROUP BY c.region, p.name, p.price",
    "generatedAt": "2026-01-11T06:34:34.381Z"
  },
  {
    "id": "q_1768113285941_nzhqvw",
    "difficulty": "intermediate",
    "question": "Find all products that have never been ordered",
    "fingerprint": "products-orders-not-exists",
    "hint": "SELECT p.id, p.name, p.category, p.price\nFROM products p\nLEFT JOIN order_items oi ON p.id = oi.product_id\nWHERE oi.product_id IS NULL\nGROUP BY p.id, p.name, p.category, p.price",
    "generatedAt": "2026-01-11T06:34:45.941Z"
  },
  {
    "id": "q_1768113298609_29xij8",
    "difficulty": "advanced",
    "question": "Find the customer who has the most orders containing products from different categories",
    "fingerprint": "customers-orders-categories-distinct-max",
    "hint": "SELECT c.id, c.name, COUNT(DISTINCT o.id) as order_count, COUNT(DISTINCT p.category) as category_count\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nWHERE o.status = 'completed'\nGROUP BY c.id, c.name\nORDER BY category_count DESC, order_count DESC\nLIMIT 1;",
    "generatedAt": "2026-01-11T06:34:58.609Z"
  },
  {
    "id": "q_1768113310585_ux6rgc",
    "difficulty": "advanced",
    "question": "Find orders where the customer has ordered at least one product from every category that exists in the database",
    "fingerprint": "orders-customers-products-categories-all-exists",
    "hint": "WITH customer_categories AS (\n  SELECT DISTINCT o.customer_id, p.category\n  FROM orders o\n  JOIN order_items oi ON o.id = oi.order_id\n  JOIN products p ON oi.product_id = p.id\n),\ntotal_categories AS (\n  SELECT COUNT(DISTINCT category) as category_count\n  FROM products\n)\nSELECT DISTINCT o.id, o.customer_id, o.order_date, o.total_amount\nFROM orders o\nJOIN customer_categories cc ON o.customer_id = cc.customer_id\nCROSS JOIN total_categories tc\nGROUP BY o.customer_id\nHAVING COUNT(DISTINCT cc.category) = tc.category_count",
    "generatedAt": "2026-01-11T06:35:10.585Z"
  },
  {
    "id": "q_1768113321541_akioik",
    "difficulty": "advanced",
    "question": "Find customers who have ordered products from at least 3 different categories",
    "fingerprint": "customers-products-categories-count-min",
    "hint": "SELECT c.name, COUNT(DISTINCT p.category) as category_count\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nWHERE o.status = 'completed'\nGROUP BY c.id, c.name\nHAVING COUNT(DISTINCT p.category) >= 3",
    "generatedAt": "2026-01-11T06:35:21.541Z"
  },
  {
    "id": "q_1768113332435_xfru34",
    "difficulty": "advanced",
    "question": "Find products that appear in every customer's completed orders",
    "fingerprint": "products-customers-orders-all-complete",
    "hint": "SELECT p.id, p.name\nFROM products p\nWHERE p.id IN (\n    SELECT oi.product_id\n    FROM order_items oi\n    JOIN orders o ON oi.order_id = o.id\n    WHERE o.status = 'completed'\n    GROUP BY oi.product_id\n    HAVING COUNT(DISTINCT o.customer_id) = (\n        SELECT COUNT(DISTINCT customer_id) \n        FROM orders \n        WHERE status = 'completed'\n    )\n);",
    "generatedAt": "2026-01-11T06:35:32.435Z"
  },
  {
    "id": "q_1768113346315_7sdiy3",
    "difficulty": "advanced",
    "question": "Find products that have been purchased together in the same order more than once across all orders",
    "fingerprint": "products-orders-together-multiple-frequency",
    "hint": "WITH product_pairs AS (\n  SELECT \n    oi1.product_id as product1,\n    oi2.product_id as product2,\n    oi1.order_id\n  FROM order_items oi1\n  JOIN order_items oi2 ON oi1.order_id = oi2.order_id \n    AND oi1.product_id < oi2.product_id\n),\npair_counts AS (\n  SELECT \n    product1,\n    product2,\n    COUNT(*) as times_together\n  FROM product_pairs\n  GROUP BY product1, product2\n  HAVING COUNT(*) > 1\n)\nSELECT \n  p1.name as product1_name,\n  p2.name as product2_name,\n  pc.times_together\nFROM pair_counts pc\nJOIN products p1 ON pc.product1 = p1.id\nJOIN products p2 ON pc.product2 = p2.id\nORDER BY pc.times_together DESC;",
    "generatedAt": "2026-01-11T06:35:46.315Z"
  },
  {
    "id": "q_1768113355443_zxvuxr",
    "difficulty": "advanced",
    "question": "Find the customer who has placed orders in the most different months across all their order history",
    "fingerprint": "customers-orders-months-distinct-max",
    "hint": "SELECT c.name, c.id,\n       COUNT(DISTINCT EXTRACT(MONTH FROM o.order_date)) as months_count\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nGROUP BY c.id, c.name\nORDER BY months_count DESC\nLIMIT 1;",
    "generatedAt": "2026-01-11T06:35:55.443Z"
  },
  {
    "id": "q_1768113369008_kr2uhx",
    "difficulty": "advanced",
    "question": "Find orders where every item in the order belongs to the same product category",
    "fingerprint": "orders-items-category-same-all",
    "hint": "SELECT DISTINCT o.id, o.customer_id, o.order_date, o.total_amount\nFROM orders o\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nWHERE o.id IN (\n    SELECT order_id\n    FROM order_items oi2\n    JOIN products p2 ON oi2.product_id = p2.id\n    GROUP BY order_id, p2.category\n    HAVING COUNT(*) = (\n        SELECT COUNT(*)\n        FROM order_items oi3\n        WHERE oi3.order_id = oi2.order_id\n    )\n)",
    "generatedAt": "2026-01-11T06:36:09.008Z"
  },
  {
    "id": "q_1768113378874_cg70zb",
    "difficulty": "advanced",
    "question": "Find customers whose average order value is higher than the overall average order value across all customers",
    "fingerprint": "customers-orders-avg-greater-overall-avg",
    "hint": "WITH customer_avg AS (\n  SELECT \n    c.id,\n    c.name,\n    AVG(o.total_amount) as avg_order_value\n  FROM customers c\n  JOIN orders o ON c.id = o.customer_id\n  GROUP BY c.id, c.name\n),\noverall_avg AS (\n  SELECT AVG(total_amount) as overall_avg\n  FROM orders\n)\nSELECT \n  ca.id,\n  ca.name,\n  ca.avg_order_value\nFROM customer_avg ca, overall_avg oa\nWHERE ca.avg_order_value > oa.overall_avg;",
    "generatedAt": "2026-01-11T06:36:18.874Z"
  },
  {
    "id": "q_1768113393549_rod4tr",
    "difficulty": "advanced",
    "question": "Find the customers who have ordered products from the same number of categories as the customer with the highest total spending",
    "fingerprint": "customers-categories-count-max-spending-equals",
    "hint": "WITH customer_spending AS (\n  SELECT c.id, c.name, SUM(o.total_amount) as total_spent\n  FROM customers c\n  JOIN orders o ON c.id = o.customer_id\n  GROUP BY c.id, c.name\n),\ntop_spender AS (\n  SELECT id FROM customer_spending \n  ORDER BY total_spent DESC LIMIT 1\n),\ncustomer_categories AS (\n  SELECT c.id, c.name, COUNT(DISTINCT p.category) as category_count\n  FROM customers c\n  JOIN orders o ON c.id = o.customer_id\n  JOIN order_items oi ON o.id = oi.order_id\n  JOIN products p ON oi.product_id = p.id\n  WHERE o.status = 'completed'\n  GROUP BY c.id, c.name\n),\ntop_spender_categories AS (\n  SELECT cc.category_count \n  FROM customer_categories cc\n  JOIN top_spender ts ON cc.id = ts.id\n)\nSELECT cc.name, cc.category_count\nFROM customer_categories cc, top_spender_categories tsc\nWHERE cc.category_count = tsc.category_count;",
    "generatedAt": "2026-01-11T06:36:33.549Z"
  },
  {
    "id": "q_1768113402573_ez4187",
    "difficulty": "advanced",
    "question": "Find products that appear in orders from at least two different regions",
    "fingerprint": "products-orders-regions-multiple-distinct",
    "hint": "SELECT DISTINCT p.name\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nJOIN orders o ON oi.order_id = o.id\nJOIN customers c ON o.customer_id = c.id\nGROUP BY p.id, p.name\nHAVING COUNT(DISTINCT c.region) >= 2",
    "generatedAt": "2026-01-11T06:36:42.573Z"
  },
  {
    "id": "q_1768113415468_biv37t",
    "difficulty": "advanced",
    "question": "Find the percentage of total revenue contributed by each product category for completed orders only",
    "fingerprint": "products-orders-category-revenue-percentage-completed",
    "hint": "SELECT \n    p.category,\n    SUM(oi.quantity * oi.unit_price) as category_revenue,\n    (SUM(oi.quantity * oi.unit_price) * 100.0 / \n     (SELECT SUM(oi2.quantity * oi2.unit_price) \n      FROM order_items oi2 \n      JOIN orders o2 ON oi2.order_id = o2.id \n      WHERE o2.status = 'completed')) as revenue_percentage\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nJOIN orders o ON oi.order_id = o.id\nWHERE o.status = 'completed'\nGROUP BY p.category",
    "generatedAt": "2026-01-11T06:36:55.468Z"
  },
  {
    "id": "q_1768113429866_wi8v5k",
    "difficulty": "advanced",
    "question": "Find customers who have placed orders in consecutive months but never ordered the same product twice",
    "fingerprint": "customers-orders-consecutive-months-distinct-products",
    "hint": "WITH customer_monthly_orders AS (\n  SELECT \n    c.id,\n    c.name,\n    EXTRACT(YEAR FROM o.order_date) as order_year,\n    EXTRACT(MONTH FROM o.order_date) as order_month,\n    oi.product_id\n  FROM customers c\n  JOIN orders o ON c.id = o.customer_id\n  JOIN order_items oi ON o.id = oi.order_id\n),\nconsecutive_months AS (\n  SELECT DISTINCT\n    id,\n    name,\n    order_year,\n    order_month,\n    LAG(order_month) OVER (PARTITION BY id ORDER BY order_year, order_month) as prev_month\n  FROM customer_monthly_orders\n),\nproduct_duplicates AS (\n  SELECT \n    id,\n    product_id,\n    COUNT(*) as product_count\n  FROM customer_monthly_orders\n  GROUP BY id, product_id\n  HAVING COUNT(*) > 1\n)\nSELECT DISTINCT cm.name\nFROM consecutive_months cm\nWHERE cm.order_month = cm.prev_month + 1\nAND cm.id NOT IN (SELECT id FROM product_duplicates);",
    "generatedAt": "2026-01-11T06:37:09.866Z"
  },
  {
    "id": "q_1768113441552_lgcesl",
    "difficulty": "advanced",
    "question": "Find products that appear together in orders more frequently than they appear separately across all completed orders",
    "fingerprint": "products-orders-cooccurrence-frequency-comparison",
    "hint": "WITH product_pairs AS (\n  SELECT \n    oi1.product_id AS product_a,\n    oi2.product_id AS product_b,\n    COUNT(DISTINCT oi1.order_id) AS together_count\n  FROM order_items oi1\n  JOIN order_items oi2 ON oi1.order_id = oi2.order_id AND oi1.product_id < oi2.product_id\n  JOIN orders o ON oi1.order_id = o.id\n  WHERE o.status = 'completed'\n  GROUP BY oi1.product_id, oi2.product_id\n),\nindividual_counts AS (\n  SELECT \n    oi.product_id,\n    COUNT(DISTINCT oi.order_id) AS individual_count\n  FROM order_items oi\n  JOIN orders o ON oi.order_id = o.id\n  WHERE o.status = 'completed'\n  GROUP BY oi.product_id\n)\nSELECT \n  pp.product_a,\n  pp.product_b,\n  pp.together_count,\n  ic1.individual_count AS count_a,\n  ic2.individual_count AS count_b\nFROM product_pairs pp\nJOIN individual_counts ic1 ON pp.product_a = ic1.product_id\nJOIN individual_counts ic2 ON pp.product_b = ic2.product_id\nWHERE pp.together_count > (ic1.individual_count - pp.together_count)\n  AND pp.together_count > (ic2.individual_count - pp.together_count)\nORDER BY pp.together_count DESC;",
    "generatedAt": "2026-01-11T06:37:21.552Z"
  },
  {
    "id": "q_1768113450538_96qupj",
    "difficulty": "advanced",
    "question": "Find products that appear in fewer completed orders than the average product appearance rate",
    "fingerprint": "products-orders-count-below-avg",
    "hint": "SELECT p.name, COUNT(DISTINCT o.id) as order_count\nFROM products p\nLEFT JOIN order_items oi ON p.id = oi.product_id\nLEFT JOIN orders o ON oi.order_id = o.id AND o.status = 'completed'\nGROUP BY p.id, p.name\nHAVING COUNT(DISTINCT o.id) < (\n    SELECT AVG(product_order_count)\n    FROM (\n        SELECT COUNT(DISTINCT o2.id) as product_order_count\n        FROM products p2\n        LEFT JOIN order_items oi2 ON p2.id = oi2.product_id\n        LEFT JOIN orders o2 ON oi2.order_id = o2.id AND o2.status = 'completed'\n        GROUP BY p2.id\n    )\n)",
    "generatedAt": "2026-01-11T06:37:30.538Z"
  },
  {
    "id": "q_1768113462993_o1zsxs",
    "difficulty": "advanced",
    "question": "Find orders where every item belongs to a different product category",
    "fingerprint": "orders-items-categories-distinct-all",
    "hint": "SELECT o.id, o.customer_id, o.order_date, o.total_amount\nFROM orders o\nWHERE o.id IN (\n    SELECT oi.order_id\n    FROM order_items oi\n    JOIN products p ON oi.product_id = p.id\n    GROUP BY oi.order_id\n    HAVING COUNT(DISTINCT p.category) = COUNT(oi.product_id)\n)\nORDER BY o.order_date;",
    "generatedAt": "2026-01-11T06:37:42.993Z"
  },
  {
    "id": "q_1768113474193_m4jott",
    "difficulty": "advanced",
    "question": "Find the customer who has the most diverse shopping habits by counting unique categories purchased across all their orders",
    "fingerprint": "customers-orders-categories-unique-count-max",
    "hint": "SELECT c.name, COUNT(p.category) as category_count\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nWHERE o.status = 'completed'\nGROUP BY c.id, c.name\nORDER BY category_count DESC\nLIMIT 1;",
    "generatedAt": "2026-01-11T06:37:54.193Z"
  },
  {
    "id": "q_1768113488362_9ey553",
    "difficulty": "advanced",
    "question": "Find the top-selling product in each month that was never the lowest-priced item in any completed order",
    "fingerprint": "products-orders-month-price-top-never-lowest",
    "hint": "WITH monthly_sales AS (\n  SELECT \n    DATE_TRUNC('month', o.order_date) as month,\n    p.id as product_id,\n    p.name as product_name,\n    SUM(oi.quantity) as total_quantity\n  FROM orders o\n  JOIN order_items oi ON o.id = oi.order_id\n  JOIN products p ON oi.product_id = p.id\n  WHERE o.status = 'completed'\n  GROUP BY DATE_TRUNC('month', o.order_date), p.id, p.name\n),\nlowest_priced_products AS (\n  SELECT DISTINCT oi.product_id\n  FROM orders o\n  JOIN order_items oi ON o.id = oi.order_id\n  WHERE o.status = 'completed'\n    AND oi.unit_price = (\n      SELECT MIN(oi2.unit_price)\n      FROM order_items oi2\n      JOIN orders o2 ON oi2.order_id = o2.id\n      WHERE o2.id = o.id AND o2.status = 'completed'\n    )\n),\nranked_products AS (\n  SELECT \n    month,\n    product_id,\n    product_name,\n    total_quantity,\n    ROW_NUMBER() OVER (PARTITION BY month ORDER BY total_quantity DESC) as rn\n  FROM monthly_sales\n  WHERE product_id NOT IN (SELECT product_id FROM lowest_priced_products)\n)\nSELECT month, product_name, total_quantity\nFROM ranked_products\nWHERE rn = 1\nORDER BY month;",
    "generatedAt": "2026-01-11T06:38:08.363Z"
  },
  {
    "id": "q_1768113500726_9emj3o",
    "difficulty": "advanced",
    "question": "Find the product that appears in the most orders alongside other products from different categories",
    "fingerprint": "products-orders-categories-count-max",
    "hint": "WITH product_order_categories AS (\n  SELECT DISTINCT \n    oi1.order_id,\n    oi1.product_id,\n    p1.category as product_category,\n    COUNT(DISTINCT p2.category) as other_categories\n  FROM order_items oi1\n  JOIN products p1 ON oi1.product_id = p1.id\n  JOIN order_items oi2 ON oi1.order_id = oi2.order_id AND oi1.product_id != oi2.product_id\n  JOIN products p2 ON oi2.product_id = p2.id AND p2.category != p1.category\n  GROUP BY oi1.order_id, oi1.product_id, p1.category\n),\nproduct_multi_category_orders AS (\n  SELECT \n    product_id,\n    COUNT(*) as multi_category_orders\n  FROM product_order_categories\n  WHERE other_categories > 0\n  GROUP BY product_id\n)\nSELECT \n  p.name,\n  pmco.multi_category_orders\nFROM product_multi_category_orders pmco\nJOIN products p ON pmco.product_id = p.id\nORDER BY pmco.multi_category_orders DESC\nLIMIT 1;",
    "generatedAt": "2026-01-11T06:38:20.726Z"
  },
  {
    "id": "q_1768113510371_l5kf4e",
    "difficulty": "advanced",
    "question": "Find products that have been ordered by customers from all three regions",
    "fingerprint": "products-customers-regions-all-join",
    "hint": "SELECT p.id, p.name\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nJOIN orders o ON oi.order_id = o.id\nJOIN customers c ON o.customer_id = c.id\nWHERE c.region IN ('West', 'East', 'Central')\nGROUP BY p.id, p.name\nHAVING COUNT(DISTINCT c.region) >= 3;",
    "generatedAt": "2026-01-11T06:38:30.371Z"
  },
  {
    "id": "q_1768113522022_zvtqj6",
    "difficulty": "advanced",
    "question": "Find orders where the total calculated from order items differs from the stored order total",
    "fingerprint": "orders-items-total-calculation-mismatch",
    "hint": "SELECT o.id, o.total_amount, SUM(oi.quantity * oi.unit_price) as calculated_total\nFROM orders o\nJOIN order_items oi ON o.id = oi.order_id\nGROUP BY o.id, o.total_amount\nHAVING o.total_amount != SUM(oi.quantity * oi.unit_price)",
    "generatedAt": "2026-01-11T06:38:42.022Z"
  }
]
